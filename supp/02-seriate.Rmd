# Seriation

```{r seriate, out.width = "100%", dpi = 300, echo=TRUE, warning=FALSE}
data <- read.csv("gahagan-diagnostics.csv")
data$context <- as.character(data$context)
rowSums(data[, 3:15])
colSums(data[, 3:15])

library(ca)
data.ca <- ca(data[, 3:15])
plot.ca(data.ca, cex=.75)

library(vegan)
data.dec <- decorana(data[, 3:15])
plot(data.dec, display="both")

library(plotrix)
rowlbl <- data$context
idx <- rev(order(data.ca$rowcoord[, 1]))
data.pct <- prop.table(as.matrix(data[, 3:15]), 1) * 100
battleship.plot(data.pct[idx, ], 
                cex.labels = .75, 
                maxxspan=.75,
                yaxlab=rowlbl[idx], 
                col="gray")

idx2 <- rev(order(data.dec$rproj[, 1]))
battleship.plot(data.pct[idx2, ], 
                cex.labels = .75, 
                maxxspan=.75,
                yaxlab=rowlbl[idx2], 
                col="gray")

plot(idx, idx2, pch=16)
abline(a=0, b=1)
```
