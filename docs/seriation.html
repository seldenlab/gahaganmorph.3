<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Seriation | Mortuary assemblage diversity, Gahagan biface morphology, and the evolution of a Caddo burial tradition in the American Southeast</title>
  <meta name="description" content="Gahagan biface shape change." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Seriation | Mortuary assemblage diversity, Gahagan biface morphology, and the evolution of a Caddo burial tradition in the American Southeast" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Gahagan biface shape change." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Seriation | Mortuary assemblage diversity, Gahagan biface morphology, and the evolution of a Caddo burial tradition in the American Southeast" />
  
  <meta name="twitter:description" content="Gahagan biface shape change." />
  

<meta name="author" content="Robert Z. Selden, Jr., John E. Dockall, and David L. Carlson" />


<meta name="date" content="2021-12-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="calibrate-model-legacy-dates.html"/>
<link rel="next" href="composition-diversity.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">gahaganmorph.3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#basis-of-inquiry"><i class="fa fa-check"></i><b>0.1</b> Basis of inquiry</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#primary-findings"><i class="fa fa-check"></i><b>0.2</b> Primary findings</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#shape-preference-as-a-function-of-burial-practice"><i class="fa fa-check"></i><b>0.2.1</b> Shape preference as a function of burial practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#data-management"><i class="fa fa-check"></i>Data management</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i>Colophon</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="calibrate-model-legacy-dates.html"><a href="calibrate-model-legacy-dates.html"><i class="fa fa-check"></i><b>1</b> Calibrate + Model Legacy Dates</a>
<ul>
<li class="chapter" data-level="1.1" data-path="calibrate-model-legacy-dates.html"><a href="calibrate-model-legacy-dates.html#calibration-and-plots-for-dates-from-burial-pit-5-at-the-mounds-plantation-site"><i class="fa fa-check"></i><b>1.1</b> Calibration and plots for dates from Burial Pit 5 at the Mounds Plantation site</a></li>
<li class="chapter" data-level="1.2" data-path="calibrate-model-legacy-dates.html"><a href="calibrate-model-legacy-dates.html#calibration-and-plots-for-dates-from-burial-pit-2-at-the-gahagan-mound-site"><i class="fa fa-check"></i><b>1.2</b> Calibration and plots for dates from Burial Pit 2 at the Gahagan Mound site</a></li>
<li class="chapter" data-level="1.3" data-path="calibrate-model-legacy-dates.html"><a href="calibrate-model-legacy-dates.html#calibration-and-plots-for-the-dates-from-f119-and-f134-at-the-george-c.-davis-site"><i class="fa fa-check"></i><b>1.3</b> Calibration and plots for the dates from F119 and F134 at the George C. Davis site</a></li>
<li class="chapter" data-level="1.4" data-path="calibrate-model-legacy-dates.html"><a href="calibrate-model-legacy-dates.html#chronological-model-for-burial-contexts-yielding-gahagan-bifaces"><i class="fa fa-check"></i><b>1.4</b> Chronological model for burial contexts yielding Gahagan bifaces</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="seriation.html"><a href="seriation.html"><i class="fa fa-check"></i><b>2</b> Seriation</a></li>
<li class="chapter" data-level="3" data-path="composition-diversity.html"><a href="composition-diversity.html"><i class="fa fa-check"></i><b>3</b> Composition &amp; Diversity</a>
<ul>
<li class="chapter" data-level="3.1" data-path="composition-diversity.html"><a href="composition-diversity.html#taxonomic-composition"><i class="fa fa-check"></i><b>3.1</b> Taxonomic composition</a></li>
<li class="chapter" data-level="3.2" data-path="composition-diversity.html"><a href="composition-diversity.html#alpha-diversity"><i class="fa fa-check"></i><b>3.2</b> Alpha diversity</a></li>
<li class="chapter" data-level="3.3" data-path="composition-diversity.html"><a href="composition-diversity.html#relative-abundance"><i class="fa fa-check"></i><b>3.3</b> Relative abundance</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="composition-diversity.html"><a href="composition-diversity.html#relative-abundance-by-context"><i class="fa fa-check"></i><b>3.3.1</b> Relative abundance by context</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="composition-diversity.html"><a href="composition-diversity.html#diversity-indices"><i class="fa fa-check"></i><b>3.4</b> Diversity indices</a></li>
<li class="chapter" data-level="3.5" data-path="composition-diversity.html"><a href="composition-diversity.html#evenness"><i class="fa fa-check"></i><b>3.5</b> Evenness</a></li>
<li class="chapter" data-level="3.6" data-path="composition-diversity.html"><a href="composition-diversity.html#beta-diversity"><i class="fa fa-check"></i><b>3.6</b> Beta diversity</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="composition-diversity.html"><a href="composition-diversity.html#beta-diversity---northern-behavioural-region"><i class="fa fa-check"></i><b>3.6.1</b> Beta diversity - Northern Behavioural Region</a></li>
<li class="chapter" data-level="3.6.2" data-path="composition-diversity.html"><a href="composition-diversity.html#beta-diversity---southern-behavioural-region"><i class="fa fa-check"></i><b>3.6.2</b> Beta diversity - Southern Behavioural Region</a></li>
<li class="chapter" data-level="3.6.3" data-path="composition-diversity.html"><a href="composition-diversity.html#beta-diversity---temporal"><i class="fa fa-check"></i><b>3.6.3</b> Beta diversity - Temporal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dgm---modeling-geometry.html"><a href="dgm---modeling-geometry.html"><i class="fa fa-check"></i><b>4</b> 3DGM - Modeling Geometry</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dgm---modeling-geometry.html"><a href="dgm---modeling-geometry.html#section"><i class="fa fa-check"></i><b>4.1</b> 4078-8</a></li>
<li class="chapter" data-level="4.2" data-path="dgm---modeling-geometry.html"><a href="dgm---modeling-geometry.html#section-1"><i class="fa fa-check"></i><b>4.2</b> 4078-72</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dgm---landmarking-protocol.html"><a href="dgm---landmarking-protocol.html"><i class="fa fa-check"></i><b>5</b> 3DGM - Landmarking Protocol</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="dgm---landmarking-protocol.html"><a href="dgm---landmarking-protocol.html#generating-the-spline"><i class="fa fa-check"></i><b>5.0.1</b> Generating the spline</a></li>
<li class="chapter" data-level="5.0.2" data-path="dgm---landmarking-protocol.html"><a href="dgm---landmarking-protocol.html#splitting-the-spline"><i class="fa fa-check"></i><b>5.0.2</b> Splitting the spline</a></li>
<li class="chapter" data-level="5.0.3" data-path="dgm---landmarking-protocol.html"><a href="dgm---landmarking-protocol.html#landmark-and-semilandmark-placement"><i class="fa fa-check"></i><b>5.0.3</b> Landmark and semilandmark placement</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dgm---analysis.html"><a href="dgm---analysis.html"><i class="fa fa-check"></i><b>6</b> 3DGM - Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dgm---analysis.html"><a href="dgm---analysis.html#load-packages-data"><i class="fa fa-check"></i><b>6.1</b> Load packages + data</a></li>
<li class="chapter" data-level="6.2" data-path="dgm---analysis.html"><a href="dgm---analysis.html#generalized-procrustes-analysis"><i class="fa fa-check"></i><b>6.2</b> Generalized Procrustes Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="dgm---analysis.html"><a href="dgm---analysis.html#boxplot"><i class="fa fa-check"></i><b>6.3</b> Boxplot</a></li>
<li class="chapter" data-level="6.4" data-path="dgm---analysis.html"><a href="dgm---analysis.html#principal-components-analysis"><i class="fa fa-check"></i><b>6.4</b> Principal Components Analysis</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="dgm---analysis.html"><a href="dgm---analysis.html#plot-pca-with-mean-shape-xy-maximaminima"><i class="fa fa-check"></i><b>6.4.1</b> Plot PCA with mean shape + x/y maxima/minima</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="dgm---analysis.html"><a href="dgm---analysis.html#procrustes-anova"><i class="fa fa-check"></i><b>6.5</b> Procrustes ANOVA</a></li>
<li class="chapter" data-level="6.6" data-path="dgm---analysis.html"><a href="dgm---analysis.html#morphological-disparity"><i class="fa fa-check"></i><b>6.6</b> Morphological disparity</a></li>
<li class="chapter" data-level="6.7" data-path="dgm---analysis.html"><a href="dgm---analysis.html#mean-shapes"><i class="fa fa-check"></i><b>6.7</b> Mean shapes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mortuary assemblage diversity, Gahagan biface morphology, and the evolution of a Caddo burial tradition in the American Southeast</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="seriation" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Seriation</h1>
<p>Load the data and summarize row and column sums. Also create gahagan_ct with only the counts using context and region as rownames. Finally create gahagan_pct with percentages.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="seriation.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ca)</span>
<span id="cb29-2"><a href="seriation.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb29-3"><a href="seriation.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># gahagan &lt;- read.csv(&quot;gahagan-diagnostics.csv&quot;)</span></span>
<span id="cb29-4"><a href="seriation.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># save(gahagan, file=&quot;gahagan-diagnostics.RData&quot;)</span></span>
<span id="cb29-5"><a href="seriation.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;gahagan-diagnostics.RData&quot;</span>)</span>
<span id="cb29-6"><a href="seriation.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure of the data frame</span></span>
<span id="cb29-7"><a href="seriation.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gahagan, <span class="at">give.attr=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    8 obs. of  15 variables:
##  $ context            : chr  &quot;41CE19-F134&quot; &quot;41CE19-F119&quot; &quot;16RR1-BP2&quot; &quot;16RR1-BP3&quot; ...
##  $ region             : chr  &quot;South&quot; &quot;South&quot; &quot;South&quot; &quot;South&quot; ...
##  $ alba               : int  157 5 31 89 35 1 12 0
##  $ celt               : int  10 3 14 3 1 0 0 0
##  $ catahoula          : int  0 0 0 0 2 0 0 4
##  $ friley             : int  0 0 0 0 1 0 1 0
##  $ gahagan            : int  16 12 16 15 1 8 2 1
##  $ hayes              : int  1 1 8 0 3 4 9 0
##  $ harrell            : int  0 0 2 0 0 0 0 0
##  $ reed               : int  0 0 16 0 0 0 0 0
##  $ scallorn           : int  0 0 19 11 0 0 19 1
##  $ coles_creek        : int  0 0 0 0 1 0 0 0
##  $ hickory_engraved   : int  0 0 1 0 1 0 0 1
##  $ holly_fine_engraved: int  0 2 1 1 1 0 0 1
##  $ kiam_incised       : int  0 0 1 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="seriation.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gahagan)</span></code></pre></div>
<pre><code>##       context region alba celt catahoula friley gahagan hayes harrell reed
## 1 41CE19-F134  South  157   10         0      0      16     1       0    0
## 2 41CE19-F119  South    5    3         0      0      12     1       0    0
## 3   16RR1-BP2  South   31   14         0      0      16     8       2   16
## 4   16RR1-BP3  South   89    3         0      0      15     0       0    0
## 5  16CD12-BP1  North   35    1         2      1       1     3       0    0
## 6  16CD12-BP2  North    1    0         0      0       8     4       0    0
## 7  16CD12-BP5  North   12    0         0      1       2     9       0    0
## 8  16CD12-BP8  North    0    0         4      0       1     0       0    0
##   scallorn coles_creek hickory_engraved holly_fine_engraved kiam_incised
## 1        0           0                0                   0            0
## 2        0           0                0                   2            0
## 3       19           0                1                   1            1
## 4       11           0                0                   1            0
## 5        0           1                1                   1            0
## 6        0           0                0                   0            0
## 7       19           0                0                   0            0
## 8        1           0                1                   1            0</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="seriation.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row sums</span></span>
<span id="cb33-2"><a href="seriation.html#cb33-2" aria-hidden="true" tabindex="-1"></a>(RS <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(gahagan[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]))</span></code></pre></div>
<pre><code>## [1] 184  23 109 119  46  13  43   8</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="seriation.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column sums</span></span>
<span id="cb35-2"><a href="seriation.html#cb35-2" aria-hidden="true" tabindex="-1"></a>CS <span class="ot">&lt;-</span> <span class="fu">colSums</span>(gahagan[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)])</span>
<span id="cb35-3"><a href="seriation.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(CS)</span></code></pre></div>
<pre><code>##                     [,1]
## alba                 330
## celt                  31
## catahoula              6
## friley                 2
## gahagan               71
## hayes                 26
## harrell                2
## reed                  16
## scallorn              50
## coles_creek            1
## hickory_engraved       3
## holly_fine_engraved    6
## kiam_incised           1</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="seriation.html#cb37-1" aria-hidden="true" tabindex="-1"></a>gahagan_ct <span class="ot">&lt;-</span> gahagan[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span>
<span id="cb37-2"><a href="seriation.html#cb37-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(gahagan<span class="sc">$</span>context, <span class="st">&quot; (&quot;</span>, <span class="fu">substr</span>(gahagan<span class="sc">$</span>region, <span class="dv">1</span>, <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb37-3"><a href="seriation.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(gahagan_ct) <span class="ot">&lt;-</span> labels</span>
<span id="cb37-4"><a href="seriation.html#cb37-4" aria-hidden="true" tabindex="-1"></a>gahagan_pct <span class="ot">&lt;-</span> gahagan_ct <span class="sc">/</span> RS  <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<p>Use the first dimension of a corresponce analysis on gahagan_ct to provide an initial ordering of the data (ca_ord).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="seriation.html#cb38-1" aria-hidden="true" tabindex="-1"></a>gahagan_ca <span class="ot">&lt;-</span> <span class="fu">ca</span>(gahagan_ct)</span>
<span id="cb38-2"><a href="seriation.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ca</span>(gahagan_ca, <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">cex =</span> .<span class="dv">75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ca-1.png" width="100%" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="seriation.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correspondence Analysis Ordering on Dimension 1</span></span>
<span id="cb39-2"><a href="seriation.html#cb39-2" aria-hidden="true" tabindex="-1"></a>(ca_ord <span class="ot">&lt;-</span> <span class="fu">order</span>(gahagan_ca<span class="sc">$</span>rowcoord[, <span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] 1 4 3 6 7 2 5 8</code></pre>
<p>Use the first projection of a detrended corresponce analysis on gahagan_ct to provide an alternate ordering of the data (dec_ord). Use correlation to compare the two sequences. Detach packages that contain functions that interfere with the seriation package.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="seriation.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb41-2"><a href="seriation.html#cb41-2" aria-hidden="true" tabindex="-1"></a>gahagan_dec <span class="ot">&lt;-</span> <span class="fu">decorana</span>(gahagan_ct)</span>
<span id="cb41-3"><a href="seriation.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gahagan_dec, <span class="at">display=</span><span class="st">&quot;species&quot;</span>)</span>
<span id="cb41-4"><a href="seriation.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(gahagan_dec, <span class="at">display=</span><span class="st">&quot;sites&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/decorana-1.png" width="100%" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="seriation.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decorana Ordering on Projection 1</span></span>
<span id="cb42-2"><a href="seriation.html#cb42-2" aria-hidden="true" tabindex="-1"></a>(dec_ord <span class="ot">&lt;-</span> <span class="fu">order</span>(gahagan_dec<span class="sc">$</span>rproj[, <span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] 1 4 5 3 2 6 7 8</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="seriation.html#cb44-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cor.test</span>(ca_ord, dec_ord, <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  ca_ord and dec_ord
## T = 16, p-value = 0.7195
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.1428571</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="seriation.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:vegan&quot;</span>)</span>
<span id="cb46-2"><a href="seriation.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:permute&quot;</span>)</span></code></pre></div>
<p>Load the seriation package to use the the manhattan distance matrices to compare the orderings. Robinson developed the method of seriation by permuting distance matrices. He used a similarity matrix where 200 was the index value for an ordering with itself. A perfect matrix should show consistent <em>decreases</em> from the diagonal horizontally and vertically. The seriation package implements this as a manhattan distance matrix where 0 is the index value for an ordering with itself. A perfect matrix should show consistent <em>increases</em> from the diagonal horizontally and vertically. The AR measure (Anti-Robinson) counts the number of times there is a decrease between adjacent values. The AR_deviation measure weights the index by the difference in values. These are loss measures meaning that low values are better. The Gradient_raw and Gradient_weighted indices are similar, but look at triplets. These are merit measures meaning that higher values are better. There are other options, but these are relatively straightforward.</p>
<p>The seriation package has multiple methods for seriating distance matrices. The ARSA (Anti-Robinson seriation by simulated annealing) method attempts to minimize the linear seriation criterion defined by Robinson. Two other methods use branch and bound algorithms (BBURCG and BBWRCG) focus on the gradient measures.</p>
<p>The five ordinations are then compared to the original order of the data. The detrended correspondence ordering is better than the correspondence ordering, but the permutation orderings are better. The ARSA and BBWRCG oderings are the same and the BBURCG ordering differs only by the switching of the positions of 16RR1-BP2 (S) and 16CD12-BP5 (N). The first (and third) orderings have the best values for AR_deviations (lowest) and Gradient_weighted (highest) whereas the second ordering has the best values for AR_events (lowest) and Gradient_raw (highest).</p>
<p>The battleship plot shows the first ordering.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="seriation.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seriation)</span>
<span id="cb47-2"><a href="seriation.html#cb47-2" aria-hidden="true" tabindex="-1"></a>gahagan_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(gahagan_pct, <span class="at">method=</span><span class="st">&quot;manhattan&quot;</span>)</span>
<span id="cb47-3"><a href="seriation.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance matrix:</span></span>
<span id="cb47-4"><a href="seriation.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(gahagan_dist, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##                 41CE19-F134 (S) 41CE19-F119 (S) 16RR1-BP2 (S) 16RR1-BP3 (S)
## 41CE19-F119 (S)           127.2                                            
## 16RR1-BP2 (S)             113.8            90.9                            
## 16RR1-BP3 (S)              28.0           124.6          92.7              
## 16CD12-BP1 (N)             38.0           134.8         117.7          40.0
## 16CD12-BP2 (N)            166.1            71.6         140.6         159.4
## 16CD12-BP5 (N)            133.8           138.5          85.3         116.4
## 16CD12-BP8 (N)            182.6           157.6         146.3         154.8
##                 16CD12-BP1 (N) 16CD12-BP2 (N) 16CD12-BP5 (N)
## 41CE19-F119 (S)                                             
## 16RR1-BP2 (S)                                               
## 16RR1-BP3 (S)                                               
## 16CD12-BP1 (N)                                              
## 16CD12-BP2 (N)           167.2                              
## 16CD12-BP5 (N)           122.4          133.5               
## 16CD12-BP8 (N)           178.3          175.0          165.7</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="seriation.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb49-2"><a href="seriation.html#cb49-2" aria-hidden="true" tabindex="-1"></a>gahagan_ser1 <span class="ot">&lt;-</span> <span class="fu">seriate</span>(gahagan_dist, <span class="at">method=</span><span class="st">&quot;ARSA&quot;</span>)</span>
<span id="cb49-3"><a href="seriation.html#cb49-3" aria-hidden="true" tabindex="-1"></a>gahagan_ser2 <span class="ot">&lt;-</span> <span class="fu">seriate</span>(gahagan_dist, <span class="at">method=</span><span class="st">&quot;BBURCG&quot;</span>)</span>
<span id="cb49-4"><a href="seriation.html#cb49-4" aria-hidden="true" tabindex="-1"></a>gahagan_ser3 <span class="ot">&lt;-</span> <span class="fu">seriate</span>(gahagan_dist, <span class="at">method=</span><span class="st">&quot;BBWRCG&quot;</span>)</span>
<span id="cb49-5"><a href="seriation.html#cb49-5" aria-hidden="true" tabindex="-1"></a>ord1 <span class="ot">&lt;-</span> <span class="fu">get_order</span>(gahagan_ser1)</span>
<span id="cb49-6"><a href="seriation.html#cb49-6" aria-hidden="true" tabindex="-1"></a>ord2 <span class="ot">&lt;-</span> <span class="fu">get_order</span>(gahagan_ser2)</span>
<span id="cb49-7"><a href="seriation.html#cb49-7" aria-hidden="true" tabindex="-1"></a>ord3 <span class="ot">&lt;-</span> <span class="fu">get_order</span>(gahagan_ser3)</span>
<span id="cb49-8"><a href="seriation.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Suggested orderings</span></span>
<span id="cb49-9"><a href="seriation.html#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(ord1, ord2, ord3)</span></code></pre></div>
<pre><code>##      16CD12-BP1 (N) 41CE19-F134 (S) 16RR1-BP3 (S) 16CD12-BP5 (N)
## ord1              5               1             4              7
## ord2              5               1             4              3
## ord3              5               1             4              7
##      16RR1-BP2 (S) 41CE19-F119 (S) 16CD12-BP2 (N) 16CD12-BP8 (N)
## ord1             3               2              6              8
## ord2             7               2              6              8
## ord3             3               2              6              8</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="seriation.html#cb51-1" aria-hidden="true" tabindex="-1"></a>Crit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AR_events&quot;</span>, <span class="st">&quot;AR_deviations&quot;</span>, <span class="st">&quot;Gradient_raw&quot;</span>, <span class="st">&quot;Gradient_weighted&quot;</span>)</span>
<span id="cb51-2"><a href="seriation.html#cb51-2" aria-hidden="true" tabindex="-1"></a>gahagan_ord1 <span class="ot">&lt;-</span> <span class="fu">permute</span>(gahagan_dist, ord1)</span>
<span id="cb51-3"><a href="seriation.html#cb51-3" aria-hidden="true" tabindex="-1"></a>gahagan_ord2 <span class="ot">&lt;-</span> <span class="fu">permute</span>(gahagan_dist, ord2)</span>
<span id="cb51-4"><a href="seriation.html#cb51-4" aria-hidden="true" tabindex="-1"></a>gahagan_ord3 <span class="ot">&lt;-</span> <span class="fu">permute</span>(gahagan_dist, ord3)</span>
<span id="cb51-5"><a href="seriation.html#cb51-5" aria-hidden="true" tabindex="-1"></a>gahagan_dec_ord <span class="ot">&lt;-</span> <span class="fu">permute</span>(gahagan_dist, dec_ord)</span>
<span id="cb51-6"><a href="seriation.html#cb51-6" aria-hidden="true" tabindex="-1"></a>gahagan_ca_ord <span class="ot">&lt;-</span> <span class="fu">permute</span>(gahagan_dist, ca_ord)</span>
<span id="cb51-7"><a href="seriation.html#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="seriation.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison between original and ordered:</span></span>
<span id="cb51-9"><a href="seriation.html#cb51-9" aria-hidden="true" tabindex="-1"></a>Results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Original=</span>gahagan_dist, <span class="at">Ordered1=</span>gahagan_ord1, <span class="at">Ordered2=</span>gahagan_ord2, <span class="at">Ordered3=</span>gahagan_ord3, <span class="at">CA=</span>gahagan_ca_ord, <span class="at">DEC=</span>gahagan_dec_ord)</span>
<span id="cb51-10"><a href="seriation.html#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sapply</span>(Results, criterion, <span class="at">method=</span>Crit), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##                   Original Ordered1 Ordered2 Ordered3     CA    DEC
## AR_events             44.0     19.0     17.0     19.0   49.0   32.0
## AR_deviations       1709.3    217.0    228.4    217.0 2335.2  584.1
## Gradient_raw          24.0     74.0     78.0     74.0   14.0   48.0
## Gradient_weighted   1227.1   3990.6   3956.5   3990.6  253.6 3176.5</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="seriation.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">battleship.plot</span>(gahagan_pct[ord1, ], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">cex.labels =</span> .<span class="dv">75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/seriation-1.png" width="100%" /></p>
<p>Since there are only eight contexts, it is feasible to consider all possible orderings to see if the preceding analysis found the best ordering. With 8 rows, there are 40,320 permutations, but half of these are reversals so we only need to consider the first 20,160 permutations. This takes a few minutes but it allows us to get the best ordering for each criterion. In this case the two “best” orderings are the same two that the seriation function provided.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="seriation.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb54-2"><a href="seriation.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seriation)</span>
<span id="cb54-3"><a href="seriation.html#cb54-3" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(gahagan_pct)</span>
<span id="cb54-4"><a href="seriation.html#cb54-4" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> <span class="fu">permutations</span>(rows)</span>
<span id="cb54-5"><a href="seriation.html#cb54-5" aria-hidden="true" tabindex="-1"></a>nperm <span class="ot">&lt;-</span> <span class="fu">factorial</span>(rows) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb54-6"><a href="seriation.html#cb54-6" aria-hidden="true" tabindex="-1"></a>all_perms <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">seq</span>(nperm), <span class="cf">function</span>(i) <span class="fu">criterion</span>(gahagan_dist, perm[i,], <span class="at">method=</span>Crit)))</span>
<span id="cb54-7"><a href="seriation.html#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="seriation.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutations which minimize AR (first two) or maximize Gradient (second two) measures:</span></span>
<span id="cb54-9"><a href="seriation.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation with mimimum AR events:</span></span>
<span id="cb54-10"><a href="seriation.html#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">which.min</span>(all_perms[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 2034</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="seriation.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation with mimimum AR deviations:</span></span>
<span id="cb56-2"><a href="seriation.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.min</span>(all_perms[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 2634</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="seriation.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation with maximum Gradient raw score:</span></span>
<span id="cb58-2"><a href="seriation.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(all_perms[, <span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] 2034</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="seriation.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation with maximum Gradient weighted score:</span></span>
<span id="cb60-2"><a href="seriation.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(all_perms[, <span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] 2634</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="seriation.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best order for event/raw count:</span></span>
<span id="cb62-2"><a href="seriation.html#cb62-2" aria-hidden="true" tabindex="-1"></a>perm[<span class="dv">2034</span>, ]</span></code></pre></div>
<pre><code>## [1] 5 1 4 3 7 2 6 8</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="seriation.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best order for deviation/weighted score:</span></span>
<span id="cb64-2"><a href="seriation.html#cb64-2" aria-hidden="true" tabindex="-1"></a>perm[<span class="dv">2634</span>, ]</span></code></pre></div>
<pre><code>## [1] 5 1 4 7 3 2 6 8</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="seriation.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles for all measures:</span></span>
<span id="cb66-2"><a href="seriation.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># AR events (lower is better):</span></span>
<span id="cb66-3"><a href="seriation.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(all_perms[, <span class="dv">1</span>], <span class="at">probs=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">01</span>, .<span class="dv">25</span>, .<span class="dv">50</span>, .<span class="dv">75</span>, .<span class="dv">99</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   0%   1%  25%  50%  75%  99% 100% 
##   17   32   49   57   63   76   84</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="seriation.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR deviations (lower is better):</span></span>
<span id="cb68-2"><a href="seriation.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">quantile</span>(all_perms[, <span class="dv">2</span>], <span class="at">probs=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">01</span>, .<span class="dv">25</span>, .<span class="dv">50</span>, .<span class="dv">75</span>, .<span class="dv">99</span>, <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##   0%   1%  25%  50%  75%  99% 100% 
##  217  729 1875 2423 3040 3823 4261</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="seriation.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient raw score (higher is better):</span></span>
<span id="cb70-2"><a href="seriation.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(all_perms[, <span class="dv">3</span>], <span class="at">probs=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">01</span>, .<span class="dv">25</span>, .<span class="dv">50</span>, .<span class="dv">75</span>, .<span class="dv">99</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   0%   1%  25%  50%  75%  99% 100% 
##  -56  -40  -14   -2   14   48   78</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="seriation.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient weighted score (higher is better):</span></span>
<span id="cb72-2"><a href="seriation.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">quantile</span>(all_perms[, <span class="dv">4</span>], <span class="at">probs=</span><span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">01</span>, .<span class="dv">25</span>, .<span class="dv">50</span>, .<span class="dv">75</span>, .<span class="dv">99</span>, <span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##    0%    1%   25%   50%   75%   99%  100% 
## -2986 -2271  -980   -38   867  2875  3991</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="seriation.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">battleship.plot</span>(gahagan_pct[perm[<span class="dv">2034</span>, ], ], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">cex.labels =</span> .<span class="dv">75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/exhaustive-1.png" width="100%" /></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="seriation.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">battleship.plot</span>(gahagan_pct[perm[<span class="dv">2634</span>, ], ], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">cex.labels =</span> .<span class="dv">75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/exhaustive-2.png" width="100%" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="seriation.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gahagan.dst &lt;- round(dist(gahagan_pct[perm[2034, ], ], method=&quot;manhattan&quot;, diag=TRUE, upper=TRUE), 1)</span></span>
<span id="cb76-2"><a href="seriation.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mar=c(0, 0, 0, 0))</span></span>
<span id="cb76-3"><a href="seriation.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># image(as.matrix(gahagan.dst), ylim=c(1.1, -0.1), asp=1, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, frame.plot=FALSE)</span></span>
<span id="cb76-4"><a href="seriation.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># image(200 - as.matrix(gahagan.dst), ylim=c(1.1, -0.1), asp=1, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, frame.plot=FALSE)</span></span></code></pre></div>
<p>We can conclude that (5 1 4 [3 7] 2 6 8) and (5 1 4 [7 3] 2 6 8) are the best seriations for these data. The brackets indicate the only difference between the two. However, given the relatively small sample sizes, it may be that sampling fluctuations could make other orderings better.</p>
<p>Running the North and South groups separately produces the same orderings (although South is reversed). Since the tied contexts were one North and one South, it did not have any effect on the separate orderings.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="seriation.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># North contexts</span></span>
<span id="cb77-2"><a href="seriation.html#cb77-2" aria-hidden="true" tabindex="-1"></a>north <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;(N)&quot;</span>, <span class="fu">rownames</span>(gahagan_pct))</span>
<span id="cb77-3"><a href="seriation.html#cb77-3" aria-hidden="true" tabindex="-1"></a>north_pct <span class="ot">&lt;-</span> gahagan_pct[north, ]</span>
<span id="cb77-4"><a href="seriation.html#cb77-4" aria-hidden="true" tabindex="-1"></a>north_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(north_pct, <span class="at">method=</span><span class="st">&quot;manhattan&quot;</span>)</span>
<span id="cb77-5"><a href="seriation.html#cb77-5" aria-hidden="true" tabindex="-1"></a>northrows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(north_pct)</span>
<span id="cb77-6"><a href="seriation.html#cb77-6" aria-hidden="true" tabindex="-1"></a>northperm <span class="ot">&lt;-</span> <span class="fu">permutations</span>(northrows)</span>
<span id="cb77-7"><a href="seriation.html#cb77-7" aria-hidden="true" tabindex="-1"></a>northnperm <span class="ot">&lt;-</span> <span class="fu">factorial</span>(northrows) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb77-8"><a href="seriation.html#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># There are only 12 permutations to check</span></span>
<span id="cb77-9"><a href="seriation.html#cb77-9" aria-hidden="true" tabindex="-1"></a>north_perms <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">seq</span>(northnperm), <span class="cf">function</span>(i) <span class="fu">criterion</span>(north_dist, northperm[i,], <span class="at">method=</span>Crit)))</span>
<span id="cb77-10"><a href="seriation.html#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(north_perms, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##       AR_events AR_deviations Gradient_raw Gradient_weighted
##  [1,]         2          55.8            4              77.7
##  [2,]         2          37.0            4             101.0
##  [3,]         2          15.8            4             164.6
##  [4,]         1           9.3            6             184.2
##  [5,]         3          55.6            2              45.2
##  [6,]         5          80.9           -2               2.4
##  [7,]         4         117.9            0              11.5
##  [8,]         4          92.6            0              54.3
##  [9,]         6         138.9           -4             -84.7
## [10,]         7         183.0           -6            -150.7
## [11,]         6         228.6           -4            -214.3
## [12,]         6         209.9           -4            -191.1</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="seriation.html#cb79-1" aria-hidden="true" tabindex="-1"></a>northbest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(north_perms[, <span class="st">&quot;AR_events&quot;</span>]), <span class="fu">which.min</span>(north_perms[, <span class="st">&quot;AR_deviations&quot;</span>]),</span>
<span id="cb79-2"><a href="seriation.html#cb79-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">which.max</span>(north_perms[, <span class="st">&quot;Gradient_raw&quot;</span>]), <span class="fu">which.max</span>(north_perms[, <span class="st">&quot;Gradient_weighted&quot;</span>]))</span>
<span id="cb79-3"><a href="seriation.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># All four criteria agree on permutation 4</span></span>
<span id="cb79-4"><a href="seriation.html#cb79-4" aria-hidden="true" tabindex="-1"></a>northbest</span></code></pre></div>
<pre><code>## [1] 4 4 4 4</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="seriation.html#cb81-1" aria-hidden="true" tabindex="-1"></a>north_ser <span class="ot">&lt;-</span> northperm[northbest[<span class="dv">1</span>], ]</span>
<span id="cb81-2"><a href="seriation.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(north_pct)[north_ser]</span></code></pre></div>
<pre><code>## [1] &quot;16CD12-BP1 (N)&quot; &quot;16CD12-BP5 (N)&quot; &quot;16CD12-BP2 (N)&quot; &quot;16CD12-BP8 (N)&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="seriation.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">battleship.plot</span>(north_pct[north_ser, ], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">cex.labels =</span> .<span class="dv">75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/twogroups-1.png" width="100%" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="seriation.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># South contexts</span></span>
<span id="cb84-2"><a href="seriation.html#cb84-2" aria-hidden="true" tabindex="-1"></a>south <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;(S)&quot;</span>, <span class="fu">rownames</span>(gahagan_pct))</span>
<span id="cb84-3"><a href="seriation.html#cb84-3" aria-hidden="true" tabindex="-1"></a>south_pct <span class="ot">&lt;-</span> gahagan_pct[south, ]</span>
<span id="cb84-4"><a href="seriation.html#cb84-4" aria-hidden="true" tabindex="-1"></a>south_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(south_pct, <span class="at">method=</span><span class="st">&quot;manhattan&quot;</span>)</span>
<span id="cb84-5"><a href="seriation.html#cb84-5" aria-hidden="true" tabindex="-1"></a>southrows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(south_pct)</span>
<span id="cb84-6"><a href="seriation.html#cb84-6" aria-hidden="true" tabindex="-1"></a>southperm <span class="ot">&lt;-</span> <span class="fu">permutations</span>(southrows)</span>
<span id="cb84-7"><a href="seriation.html#cb84-7" aria-hidden="true" tabindex="-1"></a>southnperm <span class="ot">&lt;-</span> <span class="fu">factorial</span>(southrows) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb84-8"><a href="seriation.html#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># There are only 12 permutations to check</span></span>
<span id="cb84-9"><a href="seriation.html#cb84-9" aria-hidden="true" tabindex="-1"></a>south_perms <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">seq</span>(southnperm), <span class="cf">function</span>(i) <span class="fu">criterion</span>(south_dist, southperm[i,], <span class="at">method=</span>Crit)))</span>
<span id="cb84-10"><a href="seriation.html#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(south_perms, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##       AR_events AR_deviations Gradient_raw Gradient_weighted
##  [1,]         5         359.7           -2            -271.3
##  [2,]         5         212.1           -2             -50.0
##  [3,]         2          23.7            4             252.8
##  [4,]         5         378.2           -2            -326.8
##  [5,]         6         307.8           -4            -241.3
##  [6,]         4          68.9            0             116.9
##  [7,]         0           0.0            8             323.8
##  [8,]         4         185.9            0             -34.5
##  [9,]         5         115.5           -2              51.0
## [10,]         2          45.3            4             187.9
## [11,]         5         244.6           -2            -114.9
## [12,]         5          97.0           -2             106.4</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="seriation.html#cb86-1" aria-hidden="true" tabindex="-1"></a>southbest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(south_perms[, <span class="st">&quot;AR_events&quot;</span>]), <span class="fu">which.min</span>(south_perms[, <span class="st">&quot;AR_deviations&quot;</span>]),</span>
<span id="cb86-2"><a href="seriation.html#cb86-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">which.max</span>(south_perms[, <span class="st">&quot;Gradient_raw&quot;</span>]), <span class="fu">which.max</span>(south_perms[, <span class="st">&quot;Gradient_weighted&quot;</span>]))</span>
<span id="cb86-3"><a href="seriation.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># All four criteria agree on permuation 7</span></span>
<span id="cb86-4"><a href="seriation.html#cb86-4" aria-hidden="true" tabindex="-1"></a>southbest</span></code></pre></div>
<pre><code>## [1] 7 7 7 7</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="seriation.html#cb88-1" aria-hidden="true" tabindex="-1"></a>south_ser <span class="ot">&lt;-</span> southperm[southbest[<span class="dv">1</span>], ]</span>
<span id="cb88-2"><a href="seriation.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(south_pct)[south_ser]</span></code></pre></div>
<pre><code>## [1] &quot;41CE19-F119 (S)&quot; &quot;16RR1-BP2 (S)&quot;   &quot;16RR1-BP3 (S)&quot;   &quot;41CE19-F134 (S)&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="seriation.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reverse South for battlship plot</span></span>
<span id="cb90-2"><a href="seriation.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">battleship.plot</span>(south_pct[<span class="fu">rev</span>(south_ser), ], <span class="at">col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">cex.labels =</span> .<span class="dv">75</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/twogroups-2.png" width="100%" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="calibrate-model-legacy-dates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="composition-diversity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
